<?xml version="1.0" encoding="utf-8"?>
<DayEntry xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:newtelligence-com:dasblog:runtime:data">
  <Date>2009-04-13T17:00:00-07:00</Date>
  <Entries>
    <Entry>
      <Content>&lt;p&gt;&amp;#160;&lt;/p&gt;  &lt;p&gt;I have been silent lately because I have been working on a project based on ASP.NET MVC. The idea is to have the bare minimum to create highly configurable sites.&lt;/p&gt;  &lt;p&gt;The main obstacles I saw with the framework “out of the box” is how to create composite views. &lt;/p&gt;  &lt;p&gt;This project is driven by a real need in the company I’m working right now. Let’s explore together the design and development process that we follow. Please note that I’m not saying the all the decisions taken so far are final or even the right decisions. I have changed my mind several times and there are still some things that I know I need to change to make it better.&lt;/p&gt;  &lt;p&gt;Here are the basic requirements:&lt;/p&gt;  &lt;ol&gt;   &lt;li&gt;Separation of concerns, specially separation between presentation and business logic. &lt;/li&gt;    &lt;li&gt;Views (web pages) should be written in html and they should validate before compiling. &lt;/li&gt;    &lt;li&gt;Layouts should be pluggable, supporting different sites with one installation. &lt;/li&gt;    &lt;li&gt;Content on the pages should be modular, think widgets. &lt;/li&gt;    &lt;li&gt;Different sites should be able to use different combination of widgets in the same url. &lt;/li&gt; &lt;/ol&gt;  &lt;h3&gt;1. Separation of concerns&lt;/h3&gt;  &lt;p&gt;The code needs to be easy to maintain and extend. &lt;a href="http://www.lostechies.com/blogs/jason_meridth/archive/2008/03/26/ptom-single-responsibility-principle.aspx" target="_blank"&gt;Separation of concerns&lt;/a&gt; and the rest of the &lt;a href="http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod" target="_blank"&gt;S.O.L.I.D.&lt;/a&gt; principles helps to achieve this. The first way to achieve this is to use some of the well know presentation patterns. I’m partial to MVC but I decide to take another look at MVP. I have to admit that both of them were suitable for this project, but at the end of the day, I choose MVC just because I like it better and I have more experience with other frameworks that implement it (&lt;a href="http://struts.apache.org/" target="_blank"&gt;Struts&lt;/a&gt;, &lt;a href="http://cakephp.org/" target="_blank"&gt;CakePHP&lt;/a&gt;, &lt;a href="http://rubyonrails.org/" target="_blank"&gt;RoR&lt;/a&gt;, &lt;a href="http://www.symfony-project.org/" target="_blank"&gt;Symphony&lt;/a&gt;). &lt;/p&gt;  &lt;h4&gt;&lt;/h4&gt;  &lt;h5&gt;Why ASP.NET MVC?&lt;/h5&gt;  &lt;p&gt;We choose .Net as our development technology, that left me with a few choices: &lt;a href="http://www.castleproject.org/monorail/index.html" target="_blank"&gt;MonoRails&lt;/a&gt;, &lt;a href="http://www.asp.net/mvc/" target="_blank"&gt;ASP.NET MVC&lt;/a&gt;, &lt;a href="http://code.google.com/p/fubumvc/" target="_blank"&gt;FubuMVC&lt;/a&gt;, &lt;a href="http://www.codeplex.com/SharpArchitecture" target="_blank"&gt;Sharp Architecture&lt;/a&gt;, &lt;a href="http://promesh.codeplex.com/" target="_blank"&gt;ProMeshMVC&lt;/a&gt; and a few others.&lt;/p&gt;  &lt;p&gt;I decided to go with ASP.NET MVC (note that Sharp Architecture is based on it and is more of a complete architecture). I was very tempted with ProMesh. I use it in a few pet projects and I really like it, but the community that is building behind ASP.NET MVC is a very appealing feature.&lt;/p&gt;  &lt;h3&gt;2. Views should be valid html.&lt;/h3&gt;  &lt;p&gt;Ok, I know that this is controversial. I consider myself a pragmatism. I’m a proponent of semantic html and Css based layouts instead of tables.&lt;/p&gt;  &lt;p&gt;At the same time I’m not totally against using tables in some situations. But I despise written invalid html. I’m not talking about XHTML strict (although there is not a big deal to do so), I’m just talking about valid HTML 4.0. &lt;/p&gt;  &lt;p&gt;That is a problem with most template systems out there. They all include code somehow inside the html, making the html invalid. One of the works around is to write the html, validate it and them moved into the template system of your choice, with the risk of breaking it. &lt;/p&gt;  &lt;p&gt;The solution was to create a simple html based view engine. I considered using &lt;a href="http://sparkviewengine.com/" target="_blank"&gt;Sparks&lt;/a&gt;, that is the closest thing I found to what I was looking for, but It has stuff like this: &lt;/p&gt;  &lt;pre class="geshifilter-xml"&gt;&lt;span class="sc3"&gt;&lt;span class="re1"&gt;&amp;lt;viewdata&lt;/span&gt; &lt;span class="re0"&gt;products&lt;/span&gt;=&lt;span class="st0"&gt;&amp;quot;IEnumerable[[Product]]&amp;quot;&lt;/span&gt;&lt;span class="re2"&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="sc3"&gt;&lt;span class="re1"&gt;&amp;lt;ul&lt;/span&gt; &lt;span class="re0"&gt;if&lt;/span&gt;=&lt;span class="st0"&gt;&amp;quot;products.Any()&amp;quot;&lt;/span&gt;&lt;span class="re2"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class="sc3"&gt;&lt;span class="re1"&gt;&amp;lt;li&lt;/span&gt; &lt;span class="re0"&gt;each&lt;/span&gt;=&lt;span class="st0"&gt;&amp;quot;var p in products&amp;quot;&lt;/span&gt;&lt;span class="re2"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;${p.Name}&lt;span class="sc3"&gt;&lt;span class="re1"&gt;&amp;lt;/li&lt;span class="re2"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="sc3"&gt;&lt;span class="re1"&gt;&amp;lt;/ul&lt;span class="re2"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;

&lt;p&gt;Sparks is awesome, and I will use it in my next project for another site that I’m doing but It won’t fit the bill for this one.&lt;/p&gt;

&lt;h3&gt;&lt;/h3&gt;

&lt;h3&gt;3. Support different sites with one installation.&lt;/h3&gt;

&lt;p&gt;This is a content management system, so different domains point to the same install but they should support different layouts for the same url:&lt;/p&gt;

&lt;p&gt;ex: &lt;a href="http://www.domain.com/movies/list"&gt;www.domain.com/movies/list&lt;/a&gt; should use the same code but look different to &lt;a href="http://www.anotherdomain.com/movies/list"&gt;www.anotherdomain.com/movies/list&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;/h3&gt;

&lt;h4&gt;4 and 5. Widgets on pages.&lt;/h4&gt;

&lt;p&gt;The idea is that a layout defines different areas and each can contain different widgets. Again each site should be able to define the widgets per area per layout. The code for the widgets should be independent for the controllers and the actions mapped to a url.&lt;/p&gt;

&lt;p&gt;Enough analysis, in a next post some of the code.&lt;/p&gt;</Content>
      <Created>2009-04-14T03:23:00-07:00</Created>
      <Modified>2009-04-20T21:13:27.0766549-07:00</Modified>
      <EntryId>3d7a160b-94d4-4aab-8015-fd373aaaedbb</EntryId>
      <Description />
      <Title>Silent lately</Title>
      <Categories>Programming</Categories>
      <Author>hgarcia</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>true</AllowComments>
      <Attachments />
      <Crossposts />
      <Latitude xsi:nil="true" />
      <Longitude xsi:nil="true" />
    </Entry>
  </Entries>
</DayEntry>