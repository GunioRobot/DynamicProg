---
layout: post
title: Pickle cucumber steps not recognized before creating the model.
summary: The title kind of tell it all. I started to use pickle now for filling up and managing my test with cucumber. Fill up data, etc. Pickle creates some step definitions for you to make things easy, what it's much appreciated.
categories: [General, Programming, Ruby]
---

The title kind of tell it all. I started to use pickle now for filling up and managing my test with cucumber. Fill up data, etc.

Pickle creates some step definitions for you to make things easy, what it's much appreciated. There is a great RailCast on setting things up, you can <a href="http://railscasts.com/episodes/186-pickle-with-cucumber">watch</a> it or <a href="http://asciicasts.com/episodes/186-pickle-with-cucumber">read</a> about it.

The problem I got was that I wrote the following Cucumber scenario:

{% highlight ruby %}
	@wipScenario: Assign roles Given the following roles exist 
		| name      | 
		| admin     | 
		| reader    | 
		| publisher | 
		When I am on the roles page 
		Then I should see "admin" 
		And I should see "reader" 
		And I should see "publisher"
{% endhighlight %}

And when running cucumber I got a message that indicates that I have an undefined step for the Given step and this bit of code:

<img src="../../../images/posts/missing_step.png" border="0" />

Now that was a bit disconcerting since the Given step match this pickle steps:

{% highlight ruby %}
	# create models from a table
	Given(/^the following #{capture_plural_factory} exists?:?$/) do |plural_factory, create_models_from_table(plural_factory, table) |
	end
{% endhighlight %}

Or so I though. The problem was that I didn't have the model or the db table yet. That was a bit disconcerting, I could expect the error message to tell me something more in the line of: Ups, we couldn't find a model for the User or something like.  

Once you think about it make sense, since capture_plural_factory will be evaluate on runtime and won't much any existing model.